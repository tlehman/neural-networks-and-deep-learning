<!DOCTYPE html>
<html>
<head>
    <title>tlehman's first neural network MNIST hand-written digits</title>
    <style type="text/css">
      body {
        background-color: #eee;
      }
      canvas {
        background-color: #fff;
      }
      #output {
        font-size: 20px;
      }
    </style>
</head>
<body>

  <h1>Hello, feedforward neural network</h1>

  <p>The <a href="http://yann.lecun.com/exdb/mnist/">MNIST</a> database of handwritten digits has 70,000 examples of 28x28 images of handwritten digits. Typically, 60,000 are used for training some machine learning algorithm, and the other 10,000 are used for testing.</p>

  <p>This network has 3 layers, the input layer has 28x28 = 784 neurons, the hidden layer has 100 neurons, and the output layer has 10 neurons, one for each digit. It has been pre-trained, and this page allows you to try it out by sketching out handwritten digits on the white canvas below:</p>


<canvas id="digit" width="280" height="280"
    onmousedown="startCurve()" onmouseup="endCurve()" onmousemove="updateCurve()">
</canvas>

<button id="clear" onclick="location.reload()">Clear</button>
<br />
<button id="exportImage" onclick="exportImage()">Feed into neural network</button>
<br />
<span id="output"></span>


<script type="text/javascript">
var canvas = document.getElementById("digit");
var ctx = canvas.getContext('2d');
ctx.strokeStyle = "#000000";
ctx.lineWidth = 12;
ctx.fillStyle = 'white';
ctx.fillRect(0, 0, canvas.width, canvas.height);
var drawing = false; // true when mouse is being pressed down
var output = document.getElementById("output");

function x() {
  var rect = canvas.getBoundingClientRect();
  var e = window.event;
  return e.clientX - rect.left;
}

function y() {
  var rect = canvas.getBoundingClientRect();
  var e = window.event;
  return e.clientY - rect.top;
}

function startCurve() {
  drawing = true;
  ctx.beginPath();
  ctx.moveTo(x(), y());
}

function updateCurve() {
  if(drawing === true) {
    ctx.lineTo(x(), y());
    ctx.moveTo(x(), y());
    ctx.stroke();
  }
}

function endCurve() {
  drawing = false;
  ctx.stroke();
}

function formatResponse(response) {
  data = JSON.parse(response);
  var rows = "";
  for(var i = 0; i < 10; i++) {
    rows += "<tr><td>";
    rows += i
    rows += "</td><td>";
    rows += data[i];
    rows += "</td></tr>";
  }
  return "<table>" + rows + "</table>";
}

function exportImage() {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState == 4 && xhr.status == 200) {
      output.innerHTML = formatResponse(xhr.responseText);
    }
  };
  xhr.open("POST", "//localhost:8080/recognize", true);
  xhr.send(canvas.toDataURL());
}


</script>
</body>
</html>
